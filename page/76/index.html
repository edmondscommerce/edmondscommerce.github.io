<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Edmonds Commerce Dev Blog</title>
  <meta name="author" content="EdmondsCommerce Development Team">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://edmondscommerce.github.io/page/76">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Edmonds Commerce Dev Blog" type="application/atom+xml">

  <link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">


  <script src="/javascripts/libs/jquery/jquery-2.0.3.min.js"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27853727-2', 'edmondscommerce.github.io');
  ga('send', 'pageview');

</script>

</head>

  <body   >
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img height="20" src="https://2.gravatar.com/avatar/04b807394911b26ea8a79dbe25ea4e1a?d=https%3A%2F%2Fidenticons.github.com%2Fccb745f4b144d30c4b883330a1114834.png&amp;r=x&amp;s=140" width="20"> Dev Blog</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
                
                <li ><a href="/categories/index.html">Categories</a></li>
                
                <li ><a href="/contact-us/index.html">Contact</a></li>
                
            </ul>
            <ul class="nav pull-right">
                
                
                <li><a href="http://linkedin.com/in/edmondscommerce" title="Linkedin Profile"><i class="icon-linkedin-sign social-navbar"></i></a></li>
                
                
                
                <li><a href="http://plus.google.com/104488822194646220248" title="Google+ Profile"><i class="icon-google-plus-sign social-navbar"></i></a></li>
                
                
                
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="search navbar-form navbar-right" action="http://google.com/search" method="GET">
                    <input type="hidden" name="q" value="site:edmondscommerce.github.io">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9">
    <div class="blog-index">
      
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2008-08-04T14:52:51+01:00" pubdate data-updated="true">Aug 4<span>th</span>, 2008</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/php/php-cached-download-function.html">PHP Cached Download Function</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>If you are coding a PHP script to deal with big files, it makes sense to build in some kind of caching logic so that your script won&rsquo;t download the same file every single time it is run, but will check to see how long ago it last downloaded that file and only download it again if it is more than a certain timeframe old.</p>

<p>This function allows you to do exactly that &ndash; check it out:</p>

<figure class='code panel panel-default'><figcaption class='panel-heading'><h3 class='panel-title'></h3></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nv">$cache_days</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$cache_days</span> <span class="o">=</span> <span class="nv">$cache_days</span> <span class="o">*</span> <span class="p">(</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">function</span> <span class="nf">cached_download</span><span class="p">(</span><span class="nv">$remote</span><span class="p">,</span> <span class="nv">$local</span><span class="p">){</span>
</span><span class='line'><span class="nv">$cache_days</span> <span class="o">=</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cache_days&#39;</span><span class="p">];</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$local</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$local</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="nb">time</span><span class="p">()</span> <span class="o">-</span> <span class="nv">$cache_days</span><span class="p">))){</span>
</span><span class='line'><span class="c1">// we have a local copy that is less than $cache_days old</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;</span>
</span><span class='line'><span class="s1">&lt;h3&gt;Using Cached - Last Downloaded &#39;</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;H:m:s d/m/Y&#39;</span><span class="p">,</span> <span class="nb">filemtime</span><span class="p">(</span><span class="nv">$local</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/h3&gt;</span>
</span><span class='line'><span class="s1">&#39;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;</span>
</span><span class='line'><span class="s1">&lt;h3&gt;Downloading Now...&lt;/h3&gt;</span>
</span><span class='line'><span class="s1">&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span><span class='line'><span class="nb">copy</span><span class="p">(</span><span class="nv">$remote</span><span class="p">,</span> <span class="nv">$local</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2008-07-31T15:11:08+01:00" pubdate data-updated="true">Jul 31<span>st</span>, 2008</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/php/php-recursive-create-path-if-not-exists.html">PHP: Recursive Create Path (if Not Exists)</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>Handling directories and files with PHP is a snap. However, with this handy function you can always be sure that the destination directory path for your files will exist.</p>

<p>If you pass a path with a filename at teh end, set the second parameter to true eg make_path($path, true)</p>

<figure class='code panel panel-default'><figcaption class='panel-heading'><h3 class='panel-title'></h3></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cm">/*Create  Directory Tree if Not Exists</span>
</span><span class='line'><span class="cm">If you are passing a path with a filename on the end, pass true as the second parameter to snip it off */</span>
</span><span class='line'><span class="k">function</span> <span class="nf">make_path</span><span class="p">(</span><span class="nv">$pathname</span><span class="p">,</span> <span class="nv">$is_filename</span><span class="o">=</span><span class="k">false</span><span class="p">){</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="nv">$is_filename</span><span class="p">){</span>
</span><span class='line'>
</span><span class='line'>      <span class="nv">$pathname</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$pathname</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strrpos</span><span class="p">(</span><span class="nv">$pathname</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Check if directory already exists</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$pathname</span><span class="p">)</span> <span class="o">||</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$pathname</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Ensure a file does not already exist with the same name</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$pathname</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;\\&#39;</span><span class="p">),</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span> <span class="nv">$pathname</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$pathname</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="nb">trigger_error</span><span class="p">(</span><span class="s1">&#39;mkdirr() File exists&#39;</span><span class="p">,</span> <span class="nx">E_USER_WARNING</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Crawl up the directory tree</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$next_pathname</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$pathname</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strrpos</span><span class="p">(</span><span class="nv">$pathname</span><span class="p">,</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">make_path</span><span class="p">(</span><span class="nv">$next_pathname</span><span class="p">,</span> <span class="nv">$mode</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$pathname</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">return</span> <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$pathname</span><span class="p">,</span> <span class="nv">$mode</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2008-07-18T13:09:13+01:00" pubdate data-updated="true">Jul 18<span>th</span>, 2008</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/curl/php-curl-curlopt_followlocation-and-open_basedir-or-safe-mode.html">PHP, cURL, CURLOPT FOLLOWLOCATION and Open Basedir or Safe Mode</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>If you are trying to get a curl script which needs follow on location functionality to run on a server which has either open_basedir or safe mode enabled you will get an error message similar to the following:</p>

<p><strong>CURLOPT_FOLLOWLOCATION cannot be activated when in safe_mode or an open_basedir is set</strong></p>

<p>After a bit of digging, some kind soul has put a workaround <a href="http://au.php.net/manual/ro/function.curl-setopt.php#71313">here</a></p>

<p>Here is how to use the function</p>

<figure class='code panel panel-default'><figcaption class='panel-heading'><h3 class='panel-title'></h3></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">function</span> <span class="nf">curl</span><span class="p">(</span><span class="nv">$url</span><span class="p">){</span>
</span><span class='line'><span class="nv">$go</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
</span><span class='line'><span class="nb">curl_setopt</span> <span class="p">(</span><span class="nv">$go</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
</span><span class='line'><span class="c1">//follow on location problems</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span> <span class="o">==</span> <span class="s1">&#39;Off&#39;</span><span class="p">)){</span>
</span><span class='line'>
</span><span class='line'><span class="nb">curl_setopt</span> <span class="p">(</span><span class="nv">$go</span><span class="p">,</span> <span class="nx">CURLOPT_FOLLOWLOCATION</span><span class="p">,</span> <span class="nv">$l</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$syn</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$go</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$syn</span> <span class="o">=</span> <span class="nx">curl_redir_exec</span><span class="p">(</span><span class="nv">$go</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nb">curl_close</span><span class="p">(</span><span class="nv">$go</span><span class="p">);</span>
</span><span class='line'><span class="k">return</span> <span class="nv">$syn</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//follow on location problems workaround</span>
</span><span class='line'>
</span><span class='line'><span class="k">function</span> <span class="nf">curl_redir_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="nv">$curl_loops</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="nv">$curl_max_loops</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nv">$curl_loops</span><span class="o">++</span> <span class="o">&gt;=</span> <span class="nv">$curl_max_loops</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$curl_loops</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$data</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">list</span><span class="p">(</span><span class="nv">$header</span><span class="p">,</span> <span class="nv">$data</span><span class="p">)</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$data</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$http_code</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nv">$http_code</span> <span class="o">==</span> <span class="mi">301</span> <span class="o">||</span> <span class="nv">$http_code</span> <span class="o">==</span> <span class="mi">302</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$matches</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="nb">preg_match</span><span class="p">(</span><span class="s1">&#39;/Location:(.*?)\n/&#39;</span><span class="p">,</span> <span class="nv">$header</span><span class="p">,</span> <span class="nv">$matches</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$url</span> <span class="o">=</span> <span class="o">@</span><span class="nb">parse_url</span><span class="p">(</span><span class="nx">trim</span><span class="p">(</span><span class="nb">array_pop</span><span class="p">(</span><span class="nv">$matches</span><span class="p">)));</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$url</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//couldn&#39;t process the url to redirect to</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$curl_loops</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$last_url</span> <span class="o">=</span> <span class="nb">parse_url</span><span class="p">(</span><span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_EFFECTIVE_URL</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$last_url</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$last_url</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$last_url</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$new_url</span> <span class="o">=</span> <span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;scheme&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;://&#39;</span> <span class="o">.</span> <span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;?&#39;</span><span class="o">.</span><span class="nv">$url</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$new_url</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">return</span> <span class="nx">curl_redir_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$curl_loops</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2008-07-18T10:40:19+01:00" pubdate data-updated="true">Jul 18<span>th</span>, 2008</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/regular%20expressions/regular-expression-test-tool.html">Regular Expression Test Tool</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>Creating regular expressions can sometimes be a frustrating experience. Generally I find using regular expressions intuitive and easy, with quick and powerful results. However every now and then you stumble into a regular expression scenario that you just can&rsquo;t seem to crack.</p>

<p>When this happens you might find yourself trying and trying different regular expressions and then echoing out the results and trying to figure out what is going wrong.</p>

<p>At times like this, a regular expression testing tool is invaluable. If like me though you don&rsquo;t really like to shell out on something that you are probably hardly ever going to use then this online <a rel="nofollow" href="http://www.solmetra.lt/scripts/regex/index.php">regular expression tester</a> is great.</p>

<p>Thanks goes out to these guys for hosting such a simple but eminently useful little tool :&ndash;)</p>

<p><b>Further Reading</b></p>

<p><a rel="nofollow" href="http://weblogs.asp.net/rosherove/articles/6863.aspx"><a href="http://weblogs.asp.net">http://weblogs.asp.net</a></a>
<a rel="nofollow" href="http://www.imneebu.com/2007/11/15/matching-a-valid-email-address-with-regular-expressions/"><a href="http://www.imneebu.com/">http://www.imneebu.com/</a></a>
<a rel="nofollow" href="http://openoffice.blogs.com/openoffice/2008/02/how-to-do-regul.html"><a href="http://openoffice.blogs.com/">http://openoffice.blogs.com/</a></a>
<a rel="nofollow" href="http://www.oreillygmt.co.uk/2007/02/review_of_maste.html"><a href="http://www.oreillygmt.co.uk/">http://www.oreillygmt.co.uk/</a></a>
<a rel="nofollow" href="http://spellbook.infinitiv.it/2006/07/12/php-regular-expressions.htm"><a href="http://spellbook.infinitiv.it/">http://spellbook.infinitiv.it/</a></a>
<a rel="nofollow" href="http://www.alexschultz.co.uk/weblog/2007/08/google-analytic.html"><a href="http://www.alexschultz.co.uk/">http://www.alexschultz.co.uk/</a></a>
<a rel="nofollow" href="http://www.colinneller.com/blog/RegExUserGroupTalk.aspx"><a href="http://www.colinneller.com/blog/">http://www.colinneller.com/blog/</a></a>
<a rel="nofollow" href="http://www.embracingchaos.com/2007/04/rhapsody_grease.html"><a href="http://www.embracingchaos.com/">http://www.embracingchaos.com/</a></a>
<a rel="nofollow" href="http://www.hanselman.com/blog/InternationalizedRegularExpressions.aspx"><a href="http://www.hanselman.com/blog/">http://www.hanselman.com/blog/</a></a>
<a rel="nofollow" href="http://www.phpclasses.org/browse/package/3211.html"><a href="http://www.phpclasses.org/browse/package/3211.html">http://www.phpclasses.org/browse/package/3211.html</a></a>
<a rel="nofollow" href="http://www.phpclasses.org/reviews/id/0596514271.html"><a href="http://www.phpclasses.org/reviews/id/0596514271.html">http://www.phpclasses.org/reviews/id/0596514271.html</a></a>
<a rel="nofollow" href="http://blogs.oracle.com/otn/2004/12/sql_regular_expressions_sessio.html"><a href="http://blogs.oracle.com/">http://blogs.oracle.com/</a></a></p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2008-07-09T10:21:40+01:00" pubdate data-updated="true">Jul 9<span>th</span>, 2008</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/php/excel/php-dead-easy-excel-export.html">PHP : Dead Easy Excel Export</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>Some people like their excel files. For people who want their data exported in an excel format checkout this chunk of code. It&rsquo;s really easy :&ndash;)</p>

<p>First of all you need to download this <a href="http://www.phpclasses.org/browse/package/1919.html" title="php excel" target="_blank">php excel class </a></p>

<p>Now try this code:</p>

<figure class='code panel panel-default'><figcaption class='panel-heading'><h3 class='panel-title'></h3></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nv">$query</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;select * from table&quot;</span><span class="p">);</span>
</span><span class='line'><span class="k">while</span><span class="p">(</span><span class="nv">$q</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$query</span><span class="p">)){</span>
</span><span class='line'>  <span class="nv">$output</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$q</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">require_once</span> <span class="s2">&quot;excel.php&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$export_file</span> <span class="o">=</span> <span class="s2">&quot;xlsfile://export.xls&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$export_file</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">);</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Cannot open </span><span class="si">$export_file</span><span class="s2">&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$output</span><span class="p">));</span>
</span><span class='line'><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
</span><span class='line'><span class="nx">header</span> <span class="p">(</span><span class="s2">&quot;Content-Type: application/x-msexcel&quot;</span><span class="p">);</span>
</span><span class='line'><span class="nx">header</span> <span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">exports.xls</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="p">);</span>
</span><span class='line'><span class="nb">readfile</span><span class="p">(</span><span class="s2">&quot;xlsfile://export.xls&quot;</span><span class="p">);</span>
</span><span class='line'><span class="k">exit</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s got to be the easiest thing you have ever done in PHP. Thanks goes to the excellent PHP Classes site.</p>

<p><strong>Here is some further reading:</strong>
<a rel="nofollow" href="http://ewbi.blogs.com/develops/2007/05/php_excel_formu.html">PHP Excel Formula Parser</a>
<a rel="nofollow" href="http://chumby.net/2007/03/27/php-excel-export-class/">PHP Excel Export class</a>
<a rel="nofollow" href="http://www.oracleappsblog.com/index.php/weblog/comments/88/">Export data directly to Excel by configuring the MIME Type Profile Option</a>
<a rel="nofollow" href="http://blogs.vinuthomas.com/2008/06/07/power-your-php-business-logic-with-excel/">Power your PHP Business Logic with Excel</a>
<a rel="nofollow" href="http://amiworks.co.in/talk/readingparsing-excel-spreadsheet-using-php/">Reading/Parsing Excel Spreadsheet using PHP</a>
<a rel="nofollow" href="http://jaxn.org/article/2003/11/11/using-php-to-create-excel-spreadsheets/"></a></p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2008-07-02T17:54:57+01:00" pubdate data-updated="true">Jul 2<span>nd</span>, 2008</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/php/ultimate-oscommerce-checkout-fast-and-friendly.html">Ultimate osCommerce Checkout - Fast and Friendly</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>I have recently completed the second stage of development for my ultimate oscommerce checkout system. This is a replacement for the standard osCommerce checkout which splits into numerous stages, meaning that to actually place an order meant visiting about 5 different pages.</p>

<p>My system rolls every single stage into a single page for entering details and a subsequent confirmation page simply to allow the customer to double check the details.</p>

<p>I have now finished adding full and detailed AJAX error checking so that as the customer fills out the fast checkout page, their input is checked and validated. If their input is OK the input box turns green, otherwise it turns pinky-red and a red error message box displays telling them exactly what the problem is.</p>

<p>This means that it will be nearly impossible for a customer&rsquo;s checkout process to be complicated by breaking one of the oscommerce character limits or making some other error.</p>

<p>If you want your osCommerce checkout to be as fast and userfriendly as possible then you need to sign up for:</p>

<p><strong>Edmonds Commerce Ultimate osCommerce Checkout</strong></p>

<p>Here are a few screen shots of the system running on a client site.</p>

<p><strong>Existing Customer Login</strong></p>

<p>validates email address and checks that the email address is registered</p>

<p><img src="http://www.edmondscommerce.co.uk/blog/wp-content/uploads/2008/07/screenshot-guitar-drums-and-music-shop-playrecordnet-uk-mozilla-firefox.jpg" alt="Existing Customer" /></p>

<p><strong>Validates Inputs</strong></p>

<p>Validates email addresses to help prevent typos and also checks that double entry of email or password matches up.</p>

<p><img src="http://www.edmondscommerce.co.uk/blog/wp-content/uploads/2008/07/screenshot-guitar-drums-and-music-shop-playrecordnet-uk-mozilla-firefox-1.jpg" alt="validate email" /></p>

<p><strong>Set Account, Shipping and Billing Address in One Page</strong></p>

<p>The Fast Checkout system automatically defaults the shipping and billing address to the acccount address. If the customer wants to set another address for either of these, an expandable section allows them to enter a new address or select an existing address book entry. Incorporates full AJAX error checking.</p>

<p><img src="http://www.edmondscommerce.co.uk/blog/wp-content/uploads/2008/07/screenshot-guitar-drums-and-music-shop-playrecordnet-uk-mozilla-firefox-2.jpg" alt="shipping billing address" /></p>

<p><strong>Price </strong></p>

<p>This system can be set up on your site for Â£997. If you are interested in having the ultimate checkout experience and ensuring that you convert the maximum amount of baskets then<a href="http://www.edmondscommerce.co.uk/contact-about-ultimate-oscommerce-checkout.html" title="Ultimate osCommerce Checkout"> get in touch with Edmonds Commerce today.</a></p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2008-06-20T13:02:03+01:00" pubdate data-updated="true">Jun 20<span>th</span>, 2008</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/php/email/php-email-attachment-function.html">PHP Email Attachment Function</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>Sending an email with PHP is pretty straight forwards. It&rsquo;s very useful for emailing reports generated from cron jobs etc.</p>

<p>Sometimes though you need your application to email an attachment.</p>

<p>After a load of messing around I have hacked together this email attachment PHP function.</p>

<figure class='code panel panel-default'><figcaption class='panel-heading'><h3 class='panel-title'></h3></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">function</span> <span class="nf">email_attachment</span><span class="p">(</span><span class="nv">$to_email</span><span class="p">,</span> <span class="nv">$email</span><span class="p">,</span> <span class="nv">$subject</span><span class="p">,</span><span class="nv">$our_email_name</span><span class="p">,</span> <span class="nv">$our_email</span><span class="p">,</span> <span class="nv">$file_location</span><span class="p">,</span> <span class="nv">$default_filetype</span><span class="o">=</span><span class="s1">&#39;application/zip&#39;</span><span class="p">){</span>
</span><span class='line'>  <span class="nv">$email</span> <span class="o">=</span> <span class="s1">&#39;&lt;font face=&quot;arial&quot;&gt;&#39;</span> <span class="o">.</span> <span class="nv">$email</span> <span class="o">.</span> <span class="s1">&#39;&lt;/font&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="nv">$fileatt</span> <span class="o">=</span> <span class="nv">$file_location</span><span class="p">;</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="nb">mime_content_type</span><span class="p">)){</span>
</span><span class='line'>      <span class="nv">$fileatttype</span> <span class="o">=</span> <span class="nb">mime_content_type</span><span class="p">(</span><span class="nv">$file_location</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span><span class='line'>      <span class="nv">$fileatttype</span> <span class="o">=</span> <span class="nv">$default_filetype</span><span class="p">;;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nv">$fileattname</span> <span class="o">=</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$file_location</span><span class="p">);</span>
</span><span class='line'>  <span class="c1">//prepare attachment</span>
</span><span class='line'>  <span class="nv">$file</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span> <span class="nv">$fileatt</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span> <span class="p">);</span>
</span><span class='line'>  <span class="nv">$data</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span> <span class="nv">$file</span><span class="p">,</span> <span class="nb">filesize</span><span class="p">(</span> <span class="nv">$fileatt</span> <span class="p">)</span> <span class="p">);</span>
</span><span class='line'>  <span class="nb">fclose</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">);</span>
</span><span class='line'>  <span class="nv">$data</span> <span class="o">=</span> <span class="nb">chunk_split</span><span class="p">(</span> <span class="nb">base64_encode</span><span class="p">(</span> <span class="nv">$data</span> <span class="p">)</span> <span class="p">);</span>
</span><span class='line'>  <span class="c1">//create mime boundary</span>
</span><span class='line'>  <span class="nv">$semi_rand</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span> <span class="nb">time</span><span class="p">()</span> <span class="p">);</span>
</span><span class='line'>  <span class="nv">$mime_boundary</span> <span class="o">=</span> <span class="s2">&quot;==Multipart_Boundary_x</span><span class="si">{</span><span class="nv">$semi_rand</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="c1">//create email  section</span>
</span><span class='line'>  <span class="nv">$message</span> <span class="o">=</span> <span class="s2">&quot;This is a multi-part message in MIME format.</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>  <span class="s2">&quot;--</span><span class="si">{</span><span class="nv">$mime_boundary</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>  <span class="s2">&quot;Content-type: text/html; charset=us-ascii</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>  <span class="s2">&quot;Content-Transfer-Encoding: 7bit</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>  <span class="nv">$email</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'>   <span class="c1">//create attachment section</span>
</span><span class='line'>  <span class="nv">$message</span> <span class="o">.=</span> <span class="s2">&quot;--</span><span class="si">{</span><span class="nv">$mime_boundary</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>   <span class="s2">&quot;Content-Type: </span><span class="si">{</span><span class="nv">$fileatttype</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>   <span class="s2">&quot; name=</span><span class="se">\&quot;</span><span class="si">{</span><span class="nv">$fileattname</span><span class="si">}</span><span class="se">\&quot;\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>   <span class="s2">&quot;Content-Disposition: attachment;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>   <span class="s2">&quot; filename=</span><span class="se">\&quot;</span><span class="si">{</span><span class="nv">$fileattname</span><span class="si">}</span><span class="se">\&quot;\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>   <span class="s2">&quot;Content-Transfer-Encoding: base64</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>   <span class="nv">$data</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>   <span class="s2">&quot;--</span><span class="si">{</span><span class="nv">$mime_boundary</span><span class="si">}</span><span class="s2">--</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'>   <span class="c1">//headers</span>
</span><span class='line'>  <span class="nv">$exp</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">,</span> <span class="nv">$our_email</span><span class="p">);</span>
</span><span class='line'>  <span class="nv">$domain</span> <span class="o">=</span> <span class="nv">$exp</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'>  <span class="nv">$headers</span> <span class="o">=</span> <span class="s2">&quot;From: </span><span class="si">$our_email_name</span><span class="s2">&lt;</span><span class="si">$our_email</span><span class="s2">&gt;&quot;</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="nv">$headers</span> <span class="o">.=</span> <span class="s2">&quot;Reply-To: </span><span class="si">$our_email</span><span class="s2">&quot;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="nv">$headers</span> <span class="o">.=</span> <span class="s2">&quot;Return-Path: </span><span class="si">$our_email</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>    <span class="c1">// these two to set reply address</span>
</span><span class='line'>  <span class="nv">$headers</span> <span class="o">.=</span> <span class="s2">&quot;Message-ID: &lt;&quot;</span><span class="o">.</span><span class="nb">time</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;@&quot;</span> <span class="o">.</span> <span class="nv">$domain</span> <span class="o">.</span> <span class="s2">&quot;&gt;&quot;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="nv">$headers</span> <span class="o">.=</span> <span class="s2">&quot;X-Mailer: Edmonds Commerce Email Attachment Function&quot;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>          <span class="c1">// These two to help avoid spam-filters</span>
</span><span class='line'>  <span class="nv">$headers</span> <span class="o">.=</span> <span class="s2">&quot;Date: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="nv">$headers</span> <span class="o">.=</span> <span class="s2">&quot;MIME-Version: 1.0</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>                    <span class="s2">&quot;Content-Type: multipart/mixed;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">.</span>
</span><span class='line'>                    <span class="s2">&quot; boundary=</span><span class="se">\&quot;</span><span class="si">{</span><span class="nv">$mime_boundary</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'>  
</span><span class='line'>  <span class="nb">mail</span><span class="p">(</span><span class="nv">$to_email</span><span class="p">,</span><span class="nv">$subject</span><span class="p">,</span><span class="nv">$message</span><span class="p">,</span> <span class="nv">$headers</span><span class="p">,</span> <span class="s1">&#39;-f &#39;</span> <span class="o">.</span> <span class="nv">$our_email</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span> <span class="p">(</span><span class="s1">&#39;&lt;h3 style=&quot;color: red;&quot;&gt;Mail Failed&lt;/h3&gt;&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The PHP and Email Journey Continues :&ndash;)</p>

<p>For a fully featured <a href="http://www.phpclasses.org/browse/package/2822.html" rel="nofollow">email attachment class</a> this is definitely worth checking out. If you just want a quick function though without any bells and whistles then you should find my function will do the trick.</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2008-06-11T12:08:42+01:00" pubdate data-updated="true">Jun 11<span>th</span>, 2008</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/php/get-name-from-email-address.html">Get Name From Email Address</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>Check out this simple and easy function for extracting the name from an email address. It&rsquo;s not very advanced but it is quite handy. Of course it could be used for similar applications by simply changing the character to split on.</p>

<figure class='code panel panel-default'><figcaption class='panel-heading'><h3 class='panel-title'></h3></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">function</span> <span class="nf">email_name</span><span class="p">(</span><span class="nv">$email_address</span><span class="p">,</span> <span class="nv">$split</span><span class="o">=</span><span class="s1">&#39;@&#39;</span><span class="p">){</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">ucwords</span><span class="p">(</span><span class="nx">strtolower</span><span class="p">(</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$email_address</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strripos</span><span class="p">(</span><span class="nv">$email_address</span><span class="p">,</span> <span class="nv">$split</span><span class="p">))));</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>There are some very powerful things you can do with PHP and email. Check out this <a rel="nofollow" href="http://www.phpclasses.org/browse/package/2.html">POP3 email class</a> for some ideas. I am just starting to scratch the surface of this functionality and will doubtless have some more great things to show soon.</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2008-06-09T15:36:26+01:00" pubdate data-updated="true">Jun 9<span>th</span>, 2008</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/php/freelance-oscommerce-uk.html">Freelance osCommerce UK</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>It seems that there are many UK webmasters who struggle to find a reliable UK based web developer who specialises in PHP. I have heard stories of people who claim to be osCommerce experts but in reality they simply know how to install a few contributions and that&rsquo;s about it.</p>

<p>If you are looking for a freelance osCommerce developer, especially if you would prefer to deal with someone else in the United Kingdom then you would do well to get in touch with me. I now have a long list of happy clients who have had their osCommerce sites improved, speeded up and automatically populated with huge catalogues.</p>

<p>So to clarify. Edmonds Commerce is a <b>Freelance web developer</b> who specialise in <b>osCommerce</b> and is <b>UK Based</b>.</p>

<p>Furthermore, Edmonds Commerce also specialise in all <em>osCommerce Derived Systems</em> including <b>CRE Loaded</b>, <b>Zen Cart</b> etc.</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2008-06-09T12:50:25+01:00" pubdate data-updated="true">Jun 9<span>th</span>, 2008</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/php/scraping/php-random-sleep-function-with-flush.html">PHP Random Sleep Function With Flush</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>Sometimes you want your script to pause for a short period of time before repeating a loop or proceeding to the next step. This may be to reduce server load or even to simulate the natural pauses that a person would make whilst browsing a site. This kind of thing is especially true if you are building a system to scrape content such as product information from a suppliers web site and you do not want to hammer their server to death and get your IP banned.</p>

<figure class='code panel panel-default'><figcaption class='panel-heading'><h3 class='panel-title'></h3></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'> <span class="k">function</span> <span class="nf">sleep_flush</span><span class="p">(</span><span class="nv">$chunks</span><span class="o">=</span><span class="mi">10</span><span class="p">){</span>
</span><span class='line'>
</span><span class='line'>  <span class="nv">$c</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">while</span><span class="p">(</span><span class="nv">$c</span> <span class="o">&lt;</span> <span class="nv">$chunks</span><span class="p">){</span>
</span><span class='line'>
</span><span class='line'>      <span class="nv">$rand</span> <span class="o">=</span> <span class="nx">rand</span><span class="p">(</span><span class="mi">2000000</span><span class="p">,</span> <span class="mi">6000000</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt; . . . sleeping for &#39;</span> <span class="o">.</span> <span class="nx">round</span><span class="p">((</span><span class="nv">$rand</span> <span class="o">/</span> <span class="mi">1000000</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; seconds . . . zzzzzzzzzzzzzz&lt;br&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="nb">flush</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>      <span class="nb">usleep</span><span class="p">(</span><span class="nv">$rand</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="nv">$c</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>This function will do just that for you. Also it has a built in flush which will help in preventing the script from being regarded as timed out if you are running it from the web browser.</p>
</div>
  
  


        </article>
      
    </div>

    <ul class="pager">
      
        <li class="previous"><a href="/page/77/">&larr;&nbsp;Older</a></li>
      
      <li><a href="/blog/archives">Blog Archives</a></li>
      
        <li class="next"><a href="/page/75/">Newer&nbsp;&rarr;</a></li>
      
    </ul>
  </div>

  
    <aside class="sidebar col-md-3">
      
        <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/sysadmin/goaccess-nice-cli-access-log-parsing-tool-and-how-to-install-on-centos.html">GoAccess - Nice CLI Access Log Parsing Tool (and How to Install on CentOS)</a>
    
    <a class="list-group-item " href="/bash/bash-delete-everything-but-handy-function-for-your-bashrc-file.html">Bash Delete Everything but - Handy Function for Your Bashrc File</a>
    
    <a class="list-group-item " href="/PHPStorm/compare-text-chunks-quickly-in-phpstorm.html">Compare Text Chunks Quickly in PHPStorm</a>
    
    <a class="list-group-item " href="/linux/using-pipe-viewer-for-an-easy-cli-progress-bar.html">Using Pipe Viewer for an Easy CLI Progress Bar</a>
    
    <a class="list-group-item " href="/gmail/sharing-google-drive-documents-from-gmail-when-sending-emails.html">Sharing Google Drive Documents From Gmail When Sending Emails</a>
    
  </div>
</section>




<section class="googleplus panel panel-default">
  <div class="panel-body">
    <h3>
      <a href="https://plus.google.com/104488822194646220248?rel=author">
        <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
        Google+
      </a>
    </h3>
  </div>
</section>


<section class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">About Us</h3>
    </div>
    <div class="panel-body">
        <p>
            <a href="http://www.edmondscommerce.co.uk">Edmonds Commerce</a> are a UK based E-Commerce web development
            agency.
        </p>

        <p>
            We are based in <a href="http://www.yorkshire.com/">Yorkshire</a> near <a
                href="http://www.visitleeds.co.uk/">Leeds</a> and <a href="http://www.visitbradford.com/">Bradford</a>.
        </p>

        <p>
            Our primary specialism is <a href="http://magento.com/">Magento</a> and other PHP based E-Commerce platforms
            such as <a href="http://www.opencart.com/">OpenCart</a>.
        </p>

        <p>
            In terms of technology we are very strong in:
        <ul>
            <li><a href="http://php.net/">PHP</a>,</li>
            <li><a href="http://www.mysql.com/">MySQL</a>,</li>
            <li><a href="http://www.linuxfoundation.org/">Linux</a>,</li>
            <li><a href="http://www.w3.org/standards/techs/html#w3c_all">HTML<a/>,</li>
            <li><a href="http://www.w3.org/Style/CSS/Overview.en.html">CSS</a></li>
            <li><a href="http://en.wikipedia.org/wiki/JavaScript">Javascript</a>.</li>
        </ul>
        </p>
    </div>
</section>

<section class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">Commercial Enquiries</h3>
    </div>
    <div class="panel-body">
        <p>
            If you would like to discuss your project requirements then please get in touch today.
        </p>

        <p>
            <a href="http://www.edmondscommerce.co.uk">www.edmondscommerce.co.uk</a><br/><br/>
            <a href="mailto:info@edmondscommerce.co.uk">info@edmondscommerce.co.uk</a><br/><br/>
            <a href="tel:00441274590036">+44 1274 590036</a>
        </p>
    </div>
</section>

      
    </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2014 - EdmondsCommerce Development Team<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    <script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>






  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  </body>
</html>
