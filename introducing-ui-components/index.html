<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Introducing Ui Components &middot; </title>

  
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/poole.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/poole-overrides.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/hyde-overrides.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/hyde-x.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/highlight/github.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

  
  <link href="https://edmondscommerce.github.io/favicon.ico" rel="icon">

  
  
  
  

  <meta name="description" content="">
  <meta name="keywords" content="">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'google analytics', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>
<body>
<div class="sidebar">
    <div class="container sidebar-sticky">
        <div class="sidebar-about">
            
            <a href="/"><img src="/images/eclogo.png"
                             alt="gravatar" title="">
            </a>
            
            <h1></h1>
            
        </div>
        <p>
            <a href="http://www.edmondscommerce.co.uk">Edmonds Commerce</a> are a UK based E-Commerce web development
            agency. We are based in <a href="https://www.edmondscommerce.co.uk/contact#find-us"><strong>Shipley</strong>
            which is in <strong>Yorkshire</strong> near <strong>Leeds</strong> and <strong>Bradford</strong></a>.
        </p>

        <p>
            Our primary specialism is <a href="http://magento.com/">Magento and Magento2</a> and other PHP based
            E-Commerce platforms
            such as <a href="http://www.opencart.com/">OpenCart</a>.
        </p>

        <p>
            In terms of technology we are very strong in <a href="http://php.net/">PHP</a>, <a
                href="http://www.mysql.com/">MySQL</a>, <a href="http://www.linuxfoundation.org/">Linux</a>,
            <a href="http://www.w3.org/standards/techs/html#w3c_all">HTML</a>, <a
                href="http://www.w3.org/Style/CSS/Overview.en.html">CSS</a> and <a
                href="http://en.wikipedia.org/wiki/JavaScript">Javascript</a>.


        <ul class="sidebar-nav">
            
        </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/edmondscommerce"><i class="fa fa-github-square fa-3x"></i></a>
      
      
      <a href="https://www.linkedin.com/company/edmonds-commerce"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="https://plus.google.com/104488822194646220248?rel=author"><i class="fa fa-google-plus-square fa-3x"></i></a>
      
      <a href="https://twitter.com/edmondscommerce"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="https://edmondscommerce.github.io/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
      <p>
        <a href="https://www.edmondscommerce.co.uk/contact#contact-us">Contact Form</a><br>
        <a href="mailto:info@edmondscommerce.co.uk">info@edmondscommerce.co.uk</a><br>
        <a href="tel:00441138805654">0044 113 880 5654</a>
      </p>
    </ul>

    

    </div>
</div>


<div class="content container">
  <div class="post">
    <h1 class="post-title">Introducing Ui Components</h1>
    <span class="post-date">Jan 9, 2017 &middot; 11 minute read
    
    <br/>
      <strong>Category: </strong>
    <a class="label" href="https://edmondscommerce.github.io/categories/ui-components">UI Components</a>
    </span>
    

<h1 id="contents">Contents</h1>

<ol>
<li><a href="#intro">Introduction</a></li>
<li><a href="#what_is_ui_comp">What is a UI Component</a>

<ul>
<li><a href="#structure">Structure</a></li>
<li><a href="#important_to_note">Important to Note</a></li>
</ul></li>
<li><a href="#tech_to_understand">Technologies You Need to Understand</a>

<ul>
<li><a href="#xml">XML, XHTML and XSD</a></li>
<li><a href="#knockoutjs">KnockoutJS</a></li>
<li><a href="#requirejs">RequireJS</a></li>
<li><a href="#pestle">Pestle</a></li>
</ul></li>
<li><a href="#much_components">Javascript, KnockoutJS + Magento and UI Components</a>

<ul>
<li><a href="#what_is_js_component">What is a Javascript (JS) Component?</a></li>
<li><a href="#what_is_ko_mage_component">What is a KnockoutJS + Magento component?</a></li>
<li><a href="#what_is_the_diff">What&rsquo;s the difference between the three?</a></li>
</ul></li>
<li><a href="#ui_comp_flow">UI Component Process Flow</a>

<ul>
<li><a href="#the_players">The Players</a></li>
<li><a href="#process_flow_chart">Process Flow Chart</a></li>
<li><a href="#video">Video</a></li>
</ul></li>
<li><a href="#mage_core_comps">Magento Core UI Component Examples</a>

<ul>
<li><a href="#form">Form</a></li>
<li><a href="#listing">Listing</a></li>
</ul></li>
</ol>

<p><a name="intro"></a></p>

<h1 id="introduction">Introduction</h1>

<p>Over the course of this article I will give you a whistle stop tour of UI Components.</p>

<p><a name="what_is_ui_comp"></a></p>

<h1 id="what-is-a-ui-component">What is a UI Component?</h1>

<p>In a nutshell a UI Component is an easily reusable collection of PHP, Javascript and HTML code that
provides one user interface functionality. A UI component can easily be used anywhere within your
layout files using only this small snippet.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;uiСomponent</span> <span class="na">name=</span><span class="s">&quot;some_ui_component_instance_name&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>

<p>This will make more sense <a href="#knockoutjs">later</a>, but it also looks like UI Components add the M (model)
to KnockoutJS&rsquo;s <a href="https://msdn.microsoft.com/en-us/library/hh848246.aspx" target="_blank">MVVM</a>
(or really VVM) architecture. This architecture is used to build all of Magento 2&rsquo;s front end.</p>

<p><a name="structure"></a></p>

<h2 id="structure">Structure</h2>

<p>UI Components are made up of &lsquo;Basic Components&rsquo; and &lsquo;Secondary components&rsquo;. The Basic Components are:</p>

<ul>
<li><a href="http://devdocs.magento.com/guides/v2.1/ui_comp_guide/components/ui-listing-grid.html" target="_blank">Listing Component</a> - Visualising and filtering data</li>
<li><a href="http://devdocs.magento.com/guides/v2.1/ui_comp_guide/components/ui-form.html" target="_blank">Form Component</a> - CRUD</li>
</ul>

<p>The Secondary Components can be used to extend the functionality of the Basic Components. Each Basic
Component has it&rsquo;s own set of Secondary Components. The latest devdocs (2.1) have a partial list of
all components <a href="http://devdocs.magento.com/guides/v2.1/ui_comp_guide/ui_comp_list_concept.html" target="_blank">here</a>.
You can also find all the available UI Components listed in
this <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/ui_component/etc/definition.xml#L8" target="_blank"><code>definition.xml</code></a>
(more on that later).</p>

<p><a name="important_to_note"></a></p>

<h2 id="important-to-note">Important to Note</h2>

<h3 id="you-can-t-create-custom-ui-components">You Can&rsquo;t Create Custom UI Components</h3>

<p>According to the official <a href="http://devdocs.magento.com/guides/v2.1/ui_comp_guide/bk-ui_comps.html" target="_blank">devdocs</a>,
extension developers <em>cannot</em> create custom UI Components. You can only customise existing ones. However,
Alan Storm does have a <a href="http://alanstorm.com/magento_2_simplest_xsd_valid_ui_component/" target="_blank">solution</a> (hack) for getting around this.</p>

<h3 id="ui-components-are-only-really-for-the-admin">UI Components Are Only Really for the Admin</h3>

<p>The <a href="http://devdocs.magento.com/guides/v2.1/ui_comp_guide/bk-ui_comps.html" target="_blank">devdocs</a>
state that UI Components can be used on the storefront as well as within the admin. However,
you will need to provide all your own styling and the Magento core team have not themselves used any
UI Components on the storefront.</p>

<p><a name="tech_to_understand"></a></p>

<h1 id="technologies-you-need-to-understand">Technologies You Need to Understand</h1>

<p>Before I dive into any UI Component details there are a number of technologies you <em>must</em> understand
first.</p>

<p><a name="xml"></a></p>

<h2 id="xml-xhtml-and-xsd">XML, XHTML and XSD</h2>

<h3 id="what-are-these">What Are These?</h3>

<p>If you&rsquo;ve already worked with Magento 1 then you&rsquo;ll already be (very) familiar with XML. If not,
then here&rsquo;s a short description from <a href="https://en.wikipedia.org/wiki/XML" target="_blank">Wikipedia</a>:</p>

<blockquote>
<p>Extensible Markup Language (XML) is a markup language that defines a set of rules for
encoding documents in a format that is both human-readable and machine-readable.</p>
</blockquote>

<p>XML is used for configuration files as well as the XHTML templates used by UI Components.</p>

<p>So what&rsquo;s XHTML? From <a href="https://en.wikipedia.org/wiki/XHTML" target="_blank">Wikipedia</a>:</p>

<blockquote>
<p>Extensible Hypertext Markup Language (XHTML) is part of the family of XML markup languages.
It mirrors or extends versions of the widely used Hypertext Markup Language (HTML)
&hellip;
XHTML documents are well-formed and may therefore be parsed using standard XML parsers, unlike
HTML, which requires a lenient HTML-specific parser.</p>
</blockquote>

<p>The TL;DR here is that unlike standard HTML, XHTML is strict. You can&rsquo;t use anything that isn&rsquo;t
defined within it&rsquo;s XSD schema. <a href="https://github.com/magento/magento2/blob/develop/app/code/Magento/Ui/view/base/ui_component/templates/form/default.xhtml" target="_blank">UI Component templates</a>
are all defined using XHTML.</p>

<p>So what&rsquo;s an XSD schema? From <a href="https://en.wikipedia.org/wiki/XML_Schema_(W3C)" target="_blank">Wikipedia</a>:</p>

<blockquote>
<p>XSD (XML Schema Definition), a recommendation of the World Wide Web Consortium (W3C), specifies
how to formally describe the elements in an Extensible Markup Language (XML) document.
It can be used by programmers to verify each piece of item content in a document.</p>
</blockquote>

<p>So the <a href="https://github.com/magento/magento2/blob/develop/app/code/Magento/Ui/etc/ui_components.xsd" target="_blank">XSD file</a>
defines the valid XML nodes and their structure within a given document. This is used to
validate the XHTML templates and XML configuration files within Magento 2 as well as create a DSL
(<a href="https://en.wikipedia.org/wiki/Domain-specific_language" target="_blank">Domain Specific Language</a>)
for <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Customer/view/base/ui_component/customer_form.xml" target="_blank">defining UI Components</a>.</p>

<h3 id="further-reading">Further reading</h3>

<ul>
<li><a href="https://en.wikipedia.org/wiki/XML" target="_blank">Wikipedia - XML</a></li>
<li><a href="https://en.wikipedia.org/wiki/XHTML" target="_blank">Wikipedia - XHTML</a></li>
<li><a href="https://en.wikipedia.org/wiki/XML_Schema_(W3C)" target="_blank">Wikipedia - XSD</a></li>
</ul>

<p><a name="knockoutjs"></a></p>

<h2 id="knockoutjs">KnockoutJS</h2>

<p>From the KnockoutJS site:</p>

<blockquote>
<p>Knockout is a JavaScript library that helps you to create rich, responsive display and editor user
interfaces with a clean underlying data model.</p>
</blockquote>

<h3 id="what-is-knockoutjs">What is KnockoutJS?</h3>

<p>KnockoutJS uses an MVVM (<a href="https://msdn.microsoft.com/en-us/library/hh848246.aspx" target="_blank">model&ndash;view&ndash;view-Model</a>)
architecture to create interfaces that update when an underlying data model is changed.</p>

<p>Knockout&rsquo;s MVVM looks like this:</p>

<p><img src="/images/MVVM.svg" alt="KnockoutJS MVVM" /></p>

<p>The Javascript view-model is bound to the HTML view using Knockouts custom <code>data-bind</code> attribute.
An example of this can be seen <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/ui_component/templates/form/collapsible.xhtml#L14" target="_blank">here</a>.
Now, when the Javascript
data model within the view-model changes any HTML elements which are observing this view-model will
be updated. The view-model itself is triggered to update by the same HTML elements. The view-model will
update it&rsquo;s temporary data model and pull data from / trigger updates within the Magento Model as required.</p>

<h3 id="what-s-it-used-for">What&rsquo;s It Used For?</h3>

<p>KnockoutJS is used to power the UI Component interfaces (and all other Magento 2 interfaces).
It handles templating as well as user interface updates.</p>

<h3 id="knockoutjs-customisations-made-for-magento-2">KnockoutJS Customisations made for Magento 2</h3>

<h4 id="custom-templating-engine">Custom Templating Engine</h4>

<p>The standard KnockoutJS templating engine expects the HTML templates to be present within the current page
like this:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/html&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;template_id&quot;</span><span class="p">&gt;</span>
    <span class="p">...</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div>

<p>The Magento core team have <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/lib/knockout/template/engine.js" target="_blank">customised the KnockoutJS templating engine</a>
so that it can now load templates from a remote source.</p>

<p>This feature makes it easier to reuse templates as they are no longer embedded within <code>.phtml</code> files.</p>

<h4 id="scope">Scope</h4>

<p>The Magento core team have also added a <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/lib/knockout/bindings/scope.js" target="_blank">custom <code>scope</code></a>
binding. This binding allows you to easily
bind a view-model to a template (HTML) element on a per template basis. For example:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">data-bind</span><span class="o">=</span><span class="s">&quot;scope: &#39;some_view_model.some_view_model&#39;&quot;</span><span class="p">&gt;</span>
    ...
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>

<p>This knockout view-model (listed under the <code>&quot;components&quot;</code> key within the JSON configuration) is
instantiated using the <code>Magento_Ui/js/core/app</code> Javascript component:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>&lt;script type=&quot;text/x-magento-init&quot;&gt;
{
    &quot;*&quot;: {
        &quot;Magento_Ui/js/core/app&quot;: {
            &quot;components&quot;: {
                &quot;some_view_model&quot;: {
                    &quot;component&quot;: &quot;&lt;Namespace&gt;_&lt;Module&gt;/js/view/someViewModel&quot;
                }
            }
        }
    }
}
&lt;/script&gt;
</code></pre></div>

<h3 id="further-reading-1">Further reading</h3>

<ul>
<li><a href="http://alanstorm.com/knockoutjs_primer_for_magento_developers/" target="_blank">Alan Storm - KnockoutJS Primer for Magento Developers</a></li>
<li><a href="http://alanstorm.com/magento_2_knockoutjs_integration/" target="_blank">Alan Storm - KnockoutJS Integration</a></li>
<li><a href="http://knockoutjs.com/documentation/introduction.html" target="_blank">KnockoutJS - benefits</a></li>
<li><a href="http://knockoutjs.com/documentation/observables.html" target="_blank">KnockoutJS - MVVM</a></li>
<li><a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel" target="_blank">Wikipedia - MVVM</a></li>
</ul>

<p><a name="requirejs"></a></p>

<h2 id="requirejs">RequireJS</h2>

<p>From the RequireJS site:</p>

<blockquote>
<p>RequireJS is a JavaScript file and module loader. It is optimized for in-browser use, but it can be
used in other JavaScript environments, like Rhino and Node. Using a modular script loader like
RequireJS will improve the speed and quality of your code.</p>
</blockquote>

<h3 id="what-is-requirejs">What is RequireJS?</h3>

<p>RequireJS uses the AMD (<a href="https://github.com/amdjs/amdjs-api/blob/master/AMD.md" target="_blank">Asynchronous Module Definition</a>)
standard to provide dependency management and modules. RequireJS uses lazy loading to only load a module
when it&rsquo;s required, this can speed up page load times. By implementing the AMD standard it can also load
dependencies asynchronously and provides no guarantees about the order in which a modules dependencies
will be fetched.</p>

<p>The asynchronous nature of RequireJS can be an issue for non AMD compliant modules. For example, JQuery
plugins that depend on JQuery itself. In these cases RequireJS can be configured to load one (or more)
of a modules dependencies after a subset of the other dependencies have loaded using the
<a href="http://requirejs.org/docs/api.html#config-shim" target="_blank">shim</a> configuration value.</p>

<h3 id="what-s-it-used-for-1">What&rsquo;s It Used For?</h3>

<p>All Magento 2 Javascript code (modules) make use of RequireJS to load their dependencies.</p>

<h3 id="further-reading-2">Further reading</h3>

<ul>
<li><a href="https://github.com/amdjs/amdjs-api/blob/master/AMD.md" target="_blank">AMD specification</a></li>
<li><a href="http://requirejs.org/docs/whyamd.html" target="_blank">RequireJS - AMD</a></li>
<li><a href="http://requirejs.org/docs/api.html#config-shim" target="_blank">RequireJS - Shim</a></li>
<li><a href="http://alanstorm.com/magento_2_and_requirejs/" target="_blank">Alan Storm - Magento 2 and RequireJS</a></li>
<li><a href="http://devdocs.magento.com/guides/v2.0/javascript-dev-guide/javascript/js-resources.html" target="_blank">Magento 2 devdocs - RequireJS</a></li>
</ul>

<p><a name="pestle"></a></p>

<h2 id="pestle">Pestle</h2>

<p>If you don&rsquo;t want to spend your time creating module boiler plate code / configuration then you&rsquo;ll want
to check out Pestle. Pestle is a static code generator which provides a number of
templates / helpful functions for Magento 2.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>$ php pestle list
  ...
  magento2:generate:acl
  magento2:generate:command
  magento2:generate:config_helper
  magento2:generate:crud_model
  magento2:generate:di
  magento2:generate:install
  magento2:generate:menu
  magento2:generate:module
  magento2:generate:observer
  magento2:generate:plugin_xml
  magento2:generate:preference
  magento2:generate:psr_log_level
  magento2:generate:registration
  magento2:generate:route
  magento2:generate:theme
  magento2:generate:ui:add-column-actions
  magento2:generate:ui:add-column-sections
  magento2:generate:ui:grid
  magento2:generate:view
  ...
</code></pre></div>

<h3 id="further-reading-3">Further Reading</h3>

<ul>
<li><a href="https://github.com/astorm/pestle" target="_blank">GitHub Pestle</a></li>
<li><a href="http://alanstorm.com/magento2_pestle_code_generation/" target="_blank">Alan Storm - Code Generation with Pestle</a></li>
</ul>

<p><a name="much_components"></a></p>

<h1 id="javascript-knockoutjs-magento-and-ui-components">Javascript, KnockoutJS + Magento and UI Components</h1>

<p>Did you know there are three types of component used within the Magento 2 front end?</p>

<p><a name="what_is_js_component"></a></p>

<h2 id="what-is-a-javascript-js-component">What is a Javascript (JS) Component?</h2>

<p>A JS Component is a subtype of RequireJS module. It&rsquo;s a RequireJS module that is loaded using a
<code>text/x-magento-init</code> script tag and that always returns a function.
This function is then called by core Magento code which passes any configuration values you set
within the <code>text/x-magento-init</code> script tag as arguments. <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/core/app.js" target="_blank"><code>Magento_UI/js/core/app</code></a>
that we saw above is a good example of this.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>&lt;script type=&quot;text/x-magento-init&quot;&gt;
{
    &quot;*&quot;: {
        &quot;Magento_Ui/js/core/app&quot;: { &lt;---- Module to be instantiate
            &quot;components&quot;: {       ^------ Object with all values to be passed as function arguments
                &quot;some_view_model&quot;: {
                    &quot;component&quot;: &quot;&lt;Namespace&gt;_&lt;Module&gt;/js/view/someViewModel&quot;
                }
            }
        }
    }
}
&lt;/script&gt;
</code></pre></div>

<h3 id="further-reading-4">Further Reading</h3>

<ul>
<li><a href="http://alanstorm.com/magento_2_javascript_init_scripts/" target="_blank">Alan Storm - Javascript Init Scripts</a></li>
</ul>

<p><a name="what_is_ko_mage_component"></a></p>

<h2 id="what-is-a-knockoutjs-magento-component">What is a KnockoutJS + Magento component?</h2>

<p>A plain KnockoutJS component is the grouping of a KnockoutJS template (HTML) and view-model (JS). This
component is then registered with KnockoutJS and provided a unique key. This key can then be used within
your standard HTML markup to instantiate the component.</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">data-bind</span><span class="o">=</span><span class="s">&quot;component:&#39;some-component-key&#39;&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>

<p>Due to the KnockoutJS customisations listed <a href="#knockoutjs">above</a> this process is not quite the same
in Magento. Within Magento the template is loaded via a URL and the view-model is pulled from the
registered view-models using the scope binding. These are then linked together and registered as
a component.</p>

<p><a name="what_is_the_diff"></a></p>

<h2 id="what-s-the-difference-between-the-three">What&rsquo;s the difference between the three?</h2>

<p>The naming is unfortunate here but to keep this straight in your head it&rsquo;s probably best to remember:</p>

<ul>
<li>JS Components - provide additional <em>behavioural</em> functionality.</li>
<li>KnockoutJS + Magento Components - provide additional <em>user interface</em> functionality.</li>
<li>UI Components - provide <em>building blocks</em> for creating Admin interfaces (and utilise the above two component types).</li>
</ul>

<h2 id="further-reading-5">Further Reading</h2>

<ul>
<li><a href="http://alanstorm.com/magento_2_javascript_init_scripts/" target="_blank">Alan Storm - JS Components</a></li>
<li><a href="http://alanstorm.com/knockoutjs_primer_for_magento_developers/" target="_blank">Alan Storm - Knockout Components</a></li>
<li><a href="http://devdocs.magento.com/guides/v2.0/javascript-dev-guide/javascript/js_init.html" target="_blank">Magneto 2 devdocs - JS Components</a></li>
</ul>

<p><a name="ui_comp_flow"></a></p>

<h1 id="ui-component-process-flow">UI Component Process Flow</h1>

<p><a name="the_players"></a></p>

<h2 id="the-players">The Players</h2>

<h3 id="layout">Layout</h3>

<p>This is your standard <code>&lt;handle&gt;.xml</code> layout file. You add the UI Component to the layout using:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;uiСomponent</span> <span class="na">name=</span><span class="s">&quot;some_ui_component_instance_name&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>

<h3 id="module-agnostic-configuration">Module Agnostic Configuration</h3>

<p>The <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/ui_component/etc/definition.xml" target="_blank"><code>definition.xml</code></a>
file contains all default configuration for all the UI Components available in Magento 2. It
also defines the PHP classes used to generate any JSON configuration which eventually gets passed
to KnockoutJS. Any configuration set within the <code>definition.xml</code> are global and effect all modules.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span>...
<span class="nt">&lt;form</span> <span class="na">class=</span><span class="s">&quot;Magento\Ui\Component\Form&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;argument</span> <span class="na">name=</span><span class="s">&quot;data&quot;</span> <span class="na">xsi:type=</span><span class="s">&quot;array&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">&quot;js_config&quot;</span> <span class="na">xsi:type=</span><span class="s">&quot;array&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">&quot;component&quot;</span> <span class="na">xsi:type=</span><span class="s">&quot;string&quot;</span><span class="nt">&gt;</span>Magento_Ui/js/form/form<span class="nt">&lt;/item&gt;</span>
        <span class="nt">&lt;/item&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">&quot;template&quot;</span> <span class="na">xsi:type=</span><span class="s">&quot;string&quot;</span><span class="nt">&gt;</span>templates/form/default<span class="nt">&lt;/item&gt;</span>
    <span class="nt">&lt;/argument&gt;</span>
<span class="nt">&lt;/form&gt;</span>
...
</code></pre></div>

<p>The XML above basically says; instantiate the <code>Magento\Ui\Component\Form</code> class by passing
the array of arguments contained within <code>&lt;argument&gt;</code> to it&rsquo;s constructor.</p>

<p>The first argument:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span>...
<span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">&quot;component&quot;</span> <span class="na">xsi:type=</span><span class="s">&quot;string&quot;</span><span class="nt">&gt;</span>Magento_Ui/js/form/form<span class="nt">&lt;/item&gt;</span>
...
</code></pre></div>

<p>Says use <code>magento/module-ui/view/base/web/js/form/form.js</code> as the KnockoutJS view-model for this
component.</p>

<p>The second argument:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">&quot;template&quot;</span> <span class="na">xsi:type=</span><span class="s">&quot;string&quot;</span><span class="nt">&gt;</span>templates/form/default<span class="nt">&lt;/item&gt;</span>
</code></pre></div>

<p>Means use <code>magento/module-ui/view/base/templates/form/default.phtml</code> as the default template for
this UI Component.</p>

<h3 id="top-level-configuration">Top Level Configuration</h3>

<p>The <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Customer/view/base/ui_component/customer_form.xml#L8" target="_blank"><code>&lt;component_name&gt;.xml</code></a>
file contains any configuration you wish to set on a UI Component at the module level.</p>

<p>This will usually include the arguments to be passed to the UI Components PHP constructor
<code>&lt;arguments&gt;</code>, the data source to be used by the UI Component <code>&lt;dataSource&gt;</code> and any
Secondary Components to be included.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;form</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;...&quot;</span> <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">&quot;...&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;argument</span> <span class="na">name=</span><span class="s">&quot;data&quot;</span> <span class="na">xsi:type=</span><span class="s">&quot;array&quot;</span><span class="nt">&gt;</span>
        ...
    <span class="nt">&lt;/argument&gt;</span>
    <span class="nt">&lt;dataSource</span> <span class="na">name=</span><span class="s">&quot;customer_form_data_source&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- Covered in more detail below --&gt;</span>
    <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;fieldset</span> <span class="na">name=</span><span class="s">&quot;customer&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- Secondary Component --&gt;</span>
    <span class="nt">&lt;/fieldset&gt;</span>
    <span class="nt">&lt;fieldset</span> <span class="na">name=</span><span class="s">&quot;address&quot;</span><span class="nt">&gt;</span>
        ...
    <span class="nt">&lt;/fieldset&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div>

<p>Any nodes added within the <code>&lt;form&gt;</code> node here which are not either
<code>&lt;argument&gt;</code> or <code>&lt;dataSource&gt;</code> are considered to be a new Secondary Component instance.
These can be recursively nested so a Secondary Component can contain another etc.</p>

<p>Any arguments set here will override the default values set within <code>definition.xml</code>.</p>

<h3 id="abstractcomponent">AbstractComponent</h3>

<p>Each UI Component is backed by a
<a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/Component/Form.php" target="_blank">PHP class</a>
extending from
<a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/Component/AbstractComponent.php" target="_blank"><code>Magento\Ui\Component\AbstractComponent</code></a>.
This class processes both the top level and module agnostic <code>&lt;argument&gt;</code> values and generates the
JSON configuration later used to instantiate a KnockoutJS view-model and assign a template.</p>

<h3 id="view-model-constructor">View-Model Constructor</h3>

<p>In the module agnostic configuration above we configured a view-model. This view-model is a RequireJS
module that extends from <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/lib/core/element/element.js" target="_blank">uiElement</a>.
This extended uiElement is then returned from the module to be used as a view-model constructor.</p>

<p>Default values can be set within this constructor; top level and module agnostic configuration values
take precedence over these.</p>

<p>If you require KnockoutJS you can also start adding state for your templates to observe and functions
to update / manage that state.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="nx">define</span><span class="p">([</span>
    <span class="s1">&#39;uiElement&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ko&#39;</span>
    <span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Element</span><span class="p">,</span> <span class="nx">ko</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="s2">&quot;defaults&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">template</span><span class="o">:</span> <span class="s1">&#39;&lt;Namespace&gt;_&lt;ModuleName&gt;/path/to/template&#39;</span>
        <span class="p">},</span>
        <span class="s2">&quot;some_value&quot;</span><span class="o">:</span> <span class="nx">ko</span><span class="p">.</span><span class="nx">observable</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
    <span class="p">});</span>
<span class="p">});</span>
</code></pre></div>

<h3 id="template">Template</h3>

<p>UI Component templates like <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/ui_component/templates/form/collapsible.xhtml" target="_blank"><code>collapsible.xhtml</code></a>
are set within either the view-model constructor or the module agnostic or top level configurations.</p>

<p>For the template to be rendered correctly it also needs to include the following comment:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>&lt;!-- ko template: getTemplate() --&gt;&lt;!-- /ko --&gt;
</code></pre></div>

<p>This calls the getTemplate() function on our view-model. This is inherited from
<a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/lib/core/element/element.js#L262" target="_blank">uiElement</a>.</p>

<h3 id="uiregistry">uiRegistry</h3>

<p>The <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/lib/registry/registry.js" target="_blank">uiRegistry</a>
is a Magento 2 RequireJS module that&rsquo;s used (as global state) to store all the currently
instantiated view-models. These models are stored as key value pairs. The key here maps to a
KnockoutJS scope binding value.</p>

<h3 id="engine-js-magento-ui-js-lib-knockout-template-engine">engine.js (Magento_UI/js/lib/knockout/template/engine)</h3>

<p>This <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/lib/knockout/template/engine.js" target="_blank">module</a>
implements Magento 2&rsquo;s custom KnockoutJS templating engine.</p>

<h3 id="bootstrap-js-magento-ui-js-lib-knockout-bootstrap">bootstrap.js (Magento_UI/js/lib/knockout/bootstrap)</h3>

<p>This <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/lib/knockout/bootstrap.js" target="_blank">module</a>
requires Magento 2&rsquo;s custom templating engine and sets it as KnockoutJS&rsquo;s
current templating engine.</p>

<h3 id="layout-js-magento-ui-js-core-renderer-layout">layout.js (Magento_UI/js/core/renderer/layout)</h3>

<p>This <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/core/renderer/layout.js" target="_blank">module</a>
is required by the the app module (see below) and handles the
instantiation of view-model objects. It adds these view-models to the
uiRegistry.</p>

<h3 id="app-js-magento-ui-js-core-app">app.js (Magento_UI/js/core/app)</h3>

<p>This <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/core/app.js" target="_blank">module</a>
requires the bootstrap module as well as the layout module. It calls the
function returned by the layout module starting the instantiation
of view-models.</p>

<h3 id="scope-js-magento-ui-js-lib-knockout-bindings-scope">scope.js (Magento_UI/js/lib/knockout/bindings/scope)</h3>

<p>This final <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/lib/knockout/bindings/scope.js" target="_blank">module</a>
implements Magento 2&rsquo;s custom scope binding. This module handles the linking
of view-models and views using it&rsquo;s <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/lib/knockout/bindings/scope.js#L21" target="_blank">applyComponents()</a>
function.</p>

<p><a name="process_flow_chart"></a></p>

<h2 id="process-flow-chart">Process Flow Chart</h2>

<p><br>
<img src="/images/UI Component Flow.svg" alt="UI Component Process Flow" /></p>

<p><a name="video"></a></p>

<h2 id="video">Video</h2>

<p>Here&rsquo;s a video of me stepping through the above flow in PHPStorm and Chrome.</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/oN67ZdLat7Q" frameborder="0" allowfullscreen></iframe>

<p>I&rsquo;ve extracted the PHPStorm breakpoints and added them to <a href="https://github.com/edmondscommerce/UI_Components_Breakpoints" target="_blank">this</a>
GitHub repo (just in case you want to have a go yourself).</p>

<h3 id="further-reading-6">Further Reading</h3>

<ul>
<li>See all Alan Storm links above</li>
<li><a href="http://devdocs.magento.com/guides/v2.1/ui_comp_guide/concepts/ui_comp_config_flow_concept.html" target="_blank">Magento 2 devdocs - UI Component Configuration Flow</a></li>
<li><a href="http://devdocs.magento.com/guides/v2.1/ui_comp_guide/bk-ui_comps.html" target="_blank">Magento 2 devdocs - Overview of UI Components</a></li>
</ul>

<p><a name="mage_core_comps"></a></p>

<h1 id="magento-core-ui-component-examples">Magento Core UI Component Examples</h1>

<p>Here are some links to the Magento 2 GitHub repo for you to investigate further.</p>

<p><a name="form"></a></p>

<h2 id="form">Form</h2>

<p>This is a <code>&lt;form&gt;</code> used in the <a href="https://github.com/magento/magento2/tree/develop/app/code/Magento/Theme" target="_blank"><code>Magento_Theme</code></a>
module.</p>

<ul>
<li><a href="https://github.com/magento/magento2/blob/develop/app/code/Magento/Theme/view/adminhtml/layout/theme_design_config_edit.xml#L18" target="_blank">Layout XML</a></li>
<li><a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/ui_component/etc/definition.xml" target="_blank">Module Agnostic Configuration</a></li>
<li><a href="https://github.com/magento/magento2/blob/develop/app/code/Magento/Theme/view/adminhtml/ui_component/design_config_form.xml" target="_blank">Top Level Configuration</a></li>
<li><a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/Component/Form.php" target="_blank">AbstractComponent</a></li>
<li><a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/form/form.js" target="_blank">View-Model</a></li>
<li><a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/ui_component/templates/form/collapsible.xhtml" target="_blank">Template</a></li>
</ul>

<p><a name="listing"></a></p>

<h2 id="listing">Listing</h2>

<p>This is a <code>&lt;listing&gt;</code> used in the <a href="https://github.com/magento/magento2/tree/develop/app/code/Magento/Customer" target="_blank"><code>Magento_Customer</code></a>
module.</p>

<ul>
<li><a href="https://github.com/magento/magento2/blob/develop/app/code/Magento/Customer/view/adminhtml/layout/customer_index_index.xml#L12" target="_blank">Layout XML</a></li>
<li><a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/ui_component/etc/definition.xml" target="_blank">Module Agnostic Configuration</a></li>
<li><a href="https://github.com/magento/magento2/blob/develop/app/code/Magento/Customer/view/adminhtml/ui_component/customer_listing.xml" target="_blank">Top Level Configuration</a></li>
<li><a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/Component/Listing.php" target="_blank">AbstractComponent</a></li>
<li><a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/web/js/lib/core/collection.js" target="_blank">View-Model</a></li>
<li><a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Ui/view/base/ui_component/templates/listing/default.xhtml" target="_blank">Template</a></li>
</ul>

  </div>
  
  <br/>
  <strong>Tags: </strong>
  <a class="label" href="https://edmondscommerce.github.io/tags/magento2">magento2</a><a class="label" href="https://edmondscommerce.github.io/tags/xml">xml</a><a class="label" href="https://edmondscommerce.github.io/tags/xsd">xsd</a><a class="label" href="https://edmondscommerce.github.io/tags/xhtml">xhtml</a><a class="label" href="https://edmondscommerce.github.io/tags/knockoutjs">knockoutjs</a><a class="label" href="https://edmondscommerce.github.io/tags/reactjs">reactjs</a>
  
  
</div>




<script src="https://edmondscommerce.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27853727-2', 'auto');
    ga('send', 'pageview');

</script>

</body>
</html>

